# 界面展示 - v2.1 版本信息显示

## 启动界面

### 启动日志
```bash
-----------------------------------------------------
2025-10-19 00:20:35 Port Traffic Limit v2.1 (最后更新: 2025-10-19 00:15)
```

**显示信息：**
- ✅ 当前系统时间（精确到秒）
- ✅ 脚本版本号：v2.1
- ✅ 最后更新时间：2025-10-19 00:15（精确到分钟）

---

## 主菜单界面

```bash
========== 端口流量限制管理 v2.1 ==========
最后更新: 2025-10-19 00:15

1) 添加端口配置
2) 修改端口配置
3) 解除端口限速
4) 查看端口配置及流量使用情况
5) 查看定时任务配置
0) 退出
===========================================
请选择操作 [0-5]: 
```

**新增显示：**
- ✅ 版本号在标题中：`v2.1`
- ✅ 单独一行显示更新时间：`最后更新: 2025-10-19 00:15`
- ✅ 黄色高亮显示更新时间，引起用户注意
- ✅ 空行分隔，界面更清爽

---

## 完整操作流程展示

### 1. 启动脚本

```bash
$ bash port_traffic_limit.sh

-----------------------------------------------------
2025-10-19 00:20:35 Port Traffic Limit v2.1 (最后更新: 2025-10-19 00:15)

========== 端口流量限制管理 v2.1 ==========
最后更新: 2025-10-19 00:15

1) 添加端口配置
2) 修改端口配置
3) 解除端口限速
4) 查看端口配置及流量使用情况
5) 查看定时任务配置
0) 退出
===========================================
请选择操作 [0-5]: 
```

### 2. 添加端口配置

```bash
请选择操作 [0-5]: 1

==================== 端口配置向导 ====================
提示：所有选项可直接回车使用默认值

请输入端口号 (1-65535): 8080
端口描述 [回车=Port 8080]: API服务
流量限制(GB) [回车=1000]: 500
容错范围(GB) [回车=20]: 50

配置方式：
1) 同步机器总流量配置（推荐，回车默认）
2) 自定义配置
选择 [回车=1]: 

✓ 已同步机器总流量配置
  统计模式: total | 周期: monthly (每月1日起) | 限制模式: tc
  限速值: 20kbit/s | 网络接口: eth0
                      ↑
              现在显示完整信息！

正在保存配置...
端口 8080 配置已保存
iptables规则已初始化（端口 8080）

════════════════════════════════════════
✓ 端口 8080 配置完成！
════════════════════════════════════════

按回车键继续...
```

### 3. 查看端口列表（带序号）

```bash
请选择操作 [0-5]: 4

==================== 端口配置与流量状态 ====================

[1] 端口 80 - Web服务
    流量限制: 100GB (容错: 10GB)
    限制模式: tc (20kbit/s)
    网络接口: eth0
    当前使用: 35.5GB / 100GB (35.5%)
    状态: ✅ 正常

[2] 端口 443 - HTTPS服务
    流量限制: 200GB (容错: 20GB)
    限制模式: tc (50kbit/s)
    网络接口: eth0
    当前使用: 150.2GB / 200GB (75.1%)
    状态: 🟡 需要关注

[3] 端口 8080 - API服务
    流量限制: 500GB (容错: 50GB)
    限制模式: tc (20kbit/s)
    网络接口: eth0
    当前使用: 12.3GB / 500GB (2.5%)
    状态: ✅ 正常

==========================================================

按回车键继续...
```

### 4. 修改端口配置（序号选择）

```bash
请选择操作 [0-5]: 2

==================== 已配置的端口 ====================
  [1] 端口 80 (Web服务) - 限制: 100GB, 容错: 10GB, 模式: tc
  [2] 端口 443 (HTTPS服务) - 限制: 200GB, 容错: 20GB, 模式: tc
  [3] 端口 8080 (API服务) - 限制: 500GB, 容错: 50GB, 模式: tc
====================================================

提示：可输入序号或端口号
请选择 (序号/端口号): 3         ← 输入序号，快速！
序号 3 对应端口: 8080

==================== 修改端口配置 ====================
提示：所有选项可直接回车保持原值

当前配置：
  端口: 8080
  描述: API服务
  限制: 500GB (容错: 50GB)

端口描述 [回车=API服务]: 
流量限制(GB) [回车=500]: 600     ← 修改为600GB
容错范围(GB) [回车=50]: 

正在更新配置...

✓ 端口 8080 配置已更新！

按回车键继续...
```

### 5. 解除端口限速（序号选择）

```bash
请选择操作 [0-5]: 3

==================== 已配置的端口 ====================
  [1] 端口 80 (Web服务) - 限制: 100GB, 容错: 10GB, 模式: tc
  [2] 端口 443 (HTTPS服务) - 限制: 200GB, 容错: 20GB, 模式: tc
  [3] 端口 8080 (API服务) - 限制: 600GB, 容错: 50GB, 模式: tc
====================================================

提示：可输入序号、端口号或'all'
请选择 (序号/端口号/all): 1     ← 输入序号1
序号 1 对应端口: 80
端口 80 限速已解除

按回车键继续...
```

### 6. 返回主菜单

```bash
========== 端口流量限制管理 v2.1 ==========
最后更新: 2025-10-19 00:15
          ↑
   每次返回都能看到版本信息！

1) 添加端口配置
2) 修改端口配置
3) 解除端口限速
4) 查看端口配置及流量使用情况
5) 查看定时任务配置
0) 退出
===========================================
请选择操作 [0-5]: 0

退出程序
```

---

## 版本信息的位置

### 位置1：启动日志
```bash
-----------------------------------------------------
2025-10-19 00:20:35 Port Traffic Limit v2.1 (最后更新: 2025-10-19 00:15)
```
- 写入日志文件：`/root/TrafficCop/port_traffic_monitor.log`
- 同时输出到终端
- 包含当前系统时间和版本信息

### 位置2：主菜单标题
```bash
========== 端口流量限制管理 v2.1 ==========
```
- 青色（CYAN）显示
- 版本号嵌入标题

### 位置3：更新时间行
```bash
最后更新: 2025-10-19 00:15
```
- 黄色（YELLOW）显示
- 独立一行，突出显示
- 精确到分钟

---

## 颜色方案

```bash
# 版本信息配色
标题栏：${CYAN}  (青色)
版本号：${CYAN}  (青色，融入标题)
更新时间：${YELLOW} (黄色，突出显示)

# 完整代码
echo -e "${CYAN}========== 端口流量限制管理 v${SCRIPT_VERSION} ==========${NC}"
echo -e "${YELLOW}最后更新: ${LAST_UPDATE}${NC}"
```

---

## 版本变量定义

```bash
# 在脚本头部定义（第7-8行）
SCRIPT_VERSION="2.1"
LAST_UPDATE="2025-10-19 00:15"
```

**使用方式：**
```bash
# 方式1：标题中使用
echo "v${SCRIPT_VERSION}"

# 方式2：完整信息
echo "Port Traffic Limit v${SCRIPT_VERSION} (最后更新: ${LAST_UPDATE})"

# 方式3：单独显示
echo "最后更新: ${LAST_UPDATE}"
```

---

## 用户视角

### 首次运行
```
用户看到：Port Traffic Limit v2.1 (最后更新: 2025-10-19 00:15)
用户心理：这是最新版本，2025年10月19日凌晨刚更新的
```

### 日常使用
```
每次进入主菜单都能看到：
========== 端口流量限制管理 v2.1 ==========
最后更新: 2025-10-19 00:15

用户可以确认：我使用的是最新版本
```

### 疑问时刻
```
用户想知道："这个脚本是什么时候更新的？"
答案就在菜单上：最后更新: 2025-10-19 00:15
一目了然！
```

---

## 对比展示

### ❌ 旧版本（v2.0）

```bash
========== 端口流量限制管理 v2.0 ==========
1) 添加端口配置
...
```
- 只有版本号
- 不知道更新时间
- 信息不完整

### ✅ 新版本（v2.1）

```bash
========== 端口流量限制管理 v2.1 ==========
最后更新: 2025-10-19 00:15

1) 添加端口配置
...
```
- 版本号 ✅
- 更新时间 ✅（精确到分钟）
- 信息完整 ✅

---

## 技术实现

### 修改的代码位置

1. **脚本头部（第3-8行）**
   ```bash
   # Port Traffic Limit - 端口流量限制脚本 v2.1
   # 功能：为多个端口设置独立的流量限制（支持JSON配置）
   # 最后更新：2025-10-19 00:15

   SCRIPT_VERSION="2.1"
   LAST_UPDATE="2025-10-19 00:15"
   ```

2. **启动日志（第26行）**
   ```bash
   echo "$(date '+%Y-%m-%d %H:%M:%S') Port Traffic Limit v${SCRIPT_VERSION} (最后更新: ${LAST_UPDATE})" | tee -a "$PORT_LOG_FILE"
   ```

3. **主菜单（第774-776行）**
   ```bash
   echo -e "${CYAN}========== 端口流量限制管理 v${SCRIPT_VERSION} ==========${NC}"
   echo -e "${YELLOW}最后更新: ${LAST_UPDATE}${NC}"
   echo ""
   ```

---

## 更新维护

### 每次更新时需要修改3个地方：

1. **注释中的版本号和时间**
   ```bash
   # Port Traffic Limit - 端口流量限制脚本 v2.X
   # 最后更新：YYYY-MM-DD HH:MM
   ```

2. **变量定义**
   ```bash
   SCRIPT_VERSION="2.X"
   LAST_UPDATE="YYYY-MM-DD HH:MM"
   ```

3. **版本文档**
   - 更新 `版本信息.md`
   - 更新 `README.md`

---

**展示版本：** v2.1  
**展示时间：** 2025-10-19 00:15  
**状态：** ✅ 已完成
